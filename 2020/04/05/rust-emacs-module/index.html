<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ç”¨Rustæ‰©å±•EmacsåŠŸèƒ½ | NIL</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.f49217e9.css" as="style"><link rel="preload" href="/assets/js/app.18bcd6af.js" as="script"><link rel="preload" href="/assets/js/4.3623162e.js" as="script"><link rel="preload" href="/assets/js/5.01fa82bf.js" as="script"><link rel="preload" href="/assets/js/16.1d243b02.js" as="script"><link rel="prefetch" href="/assets/js/1.8cf47d9f.js"><link rel="prefetch" href="/assets/js/10.9c95be4e.js"><link rel="prefetch" href="/assets/js/11.1d1a5d83.js"><link rel="prefetch" href="/assets/js/12.e06dd46f.js"><link rel="prefetch" href="/assets/js/13.82bd8097.js"><link rel="prefetch" href="/assets/js/14.a4f4c54e.js"><link rel="prefetch" href="/assets/js/15.52fc6e9d.js"><link rel="prefetch" href="/assets/js/17.059975a5.js"><link rel="prefetch" href="/assets/js/18.8cc69377.js"><link rel="prefetch" href="/assets/js/19.ecc651c2.js"><link rel="prefetch" href="/assets/js/20.7db988d4.js"><link rel="prefetch" href="/assets/js/21.0ba8fddc.js"><link rel="prefetch" href="/assets/js/6.b4898728.js"><link rel="prefetch" href="/assets/js/7.4032b5ee.js"><link rel="prefetch" href="/assets/js/8.843bf780.js"><link rel="prefetch" href="/assets/js/9.c18d5d6f.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.c949d70e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f49217e9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuperess-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">NIL
        </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></li><li class="nav-item"><a href="/tag/" class="nav-link">æ ‡ç­¾</a></li><li class="nav-item"><a href="/about.html" class="nav-link">å…³äº</a></li><li class="nav-item"><a href="/links.html" class="nav-link">å‹æƒ…é“¾æ¥</a></li><li class="nav-item"><a href="https://cireu.github.io/rss.xml" target="_blank" rel="noopener noreferrer" class="nav-link external">RSS</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">NIL
      </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">æ ‡ç­¾</a></li><li class="mobile-nav-item"><a href="/about.html" class="nav-link">å…³äº</a></li><li class="mobile-nav-item"><a href="/links.html" class="nav-link">å‹æƒ…é“¾æ¥</a></li><li class="mobile-nav-item"><a href="https://cireu.github.io/rss.xml" target="_blank" rel="noopener noreferrer" class="nav-link external">RSS</a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuperess-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><div class="content__default"><h1 id="ç”¨rustæ‰©å±•emacsåŠŸèƒ½"><a href="#ç”¨rustæ‰©å±•emacsåŠŸèƒ½" class="header-anchor">#</a> ç”¨ Rust æ‰©å±• Emacs åŠŸèƒ½</h1> <h2 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="header-anchor">#</a> æ‘˜è¦</h2> <p>åœ¨ Emacs 25 ä¸­ï¼ŒEmacs å¼•å…¥äº†ã€åŠ¨æ€æ¨¡å—ã€ï¼ˆdynamic moduleï¼‰çš„æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨ C
 è¯­è¨€è§„å®šçš„åŠ¨æ€é“¾æ¥åº“æ ¼å¼æ‰©å±• Emacs æœ¬èº«æ‰€ç¼ºä¹çš„èƒ½åŠ›ã€‚</p> <p>æœ¬æ–‡é˜é‡Šäº†ä½¿ç”¨ Rust å¼€å‘åŠ¨æ€æ¨¡å—ç›¸å¯¹äº C è¯­è¨€çš„ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»è®²è§£å¦‚ä½•ä½¿ç”¨
<a href="https://github.com/ubolonton/emacs-module-rs" target="_blank" rel="noopener noreferrer"> ubolonto<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å¼€å‘çš„
<a href="https://github.com/ubolonton/emacs-module-rs" target="_blank" rel="noopener noreferrer"> emacs-module-rs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç®€åŒ– Rust åŠ¨æ€æ¨¡ç»„å¼€å‘
æµç¨‹ã€‚</p> <h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©rustè€Œä¸æ˜¯c"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©rustè€Œä¸æ˜¯c" class="header-anchor">#</a> ä¸ºä»€ä¹ˆé€‰æ‹© Rust è€Œä¸æ˜¯ C</h2> <p>C è¯­è¨€ä½œä¸ºä¸€é—¨ä¸Šä¸–çºª 70 å¹´ä»£å‘æ˜çš„ç¼–ç¨‹è¯­è¨€ï¼Œå…¶å†å²å±€é™æ€§ååˆ†ä¸¥é‡ã€‚å¯ä»¥è®¤ä¸ºï¼ŒC è¯­è¨€çš„
ä¸€äº›ç¼ºé™·ï¼Œé˜»ç¢äº†åŠ¨æ€æ¨¡å—è¿™ä¸€æ‰©å±•æ–¹å¼çš„æµè¡Œã€‚</p> <ul><li>è¯­è¨€æœ¬èº«è¿‡äºåº•å±‚ï¼Œç¼ºä¹è¡¨è¾¾èƒ½åŠ›ï¼Œéœ€è¦æµªè´¹ç²¾åŠ›åœ¨å†…å­˜ç®¡ç†ä¸Šã€‚å¯¹èšç„¦äºä»£ç é€»è¾‘æœ¬èº«
çš„å¿«é€Ÿå¼€å‘ä¸å¤Ÿæ–¹ä¾¿ã€‚</li> <li>ç¼ºä¹è‰¯å¥½çš„ç±»å‹çº¦æŸï¼Œå®¹æ˜“å†™å‡ºå†…å­˜ä¸å®‰å…¨çš„ä»£ç ã€‚</li> <li>ç¼ºå°‘ä¸­å¿ƒåŒ–çš„åŒ…åˆ†å‘ç®¡ç†ç³»ç»Ÿï¼Œè·å–æ„å»ºä¾èµ–ååˆ†éº»çƒ¦ã€‚</li> <li>ä¸åŒç”¨æˆ·ä¸Šçš„ C è¯­è¨€ç¼–è¯‘å™¨å’Œ C è¯­è¨€è¿è¡Œæ—¶ä¸åŒï¼Œåœ¨ç”¨æˆ·æ„å»ºä½¿ç”¨æ—¶å®¹æ˜“å‡ºç°éš¾ä»¥å¤ç°çš„
 BUG</li></ul> <p>Rust ä½œä¸ºä¸€é—¨æ–°æ—¶ä»£çš„ï¼Œèšç„¦äºå†…å­˜å®‰å…¨ï¼Œåº•å±‚æ•ˆç‡ä»¥åŠå¹¶å‘çš„è¯­è¨€ï¼Œæ­£å¥½å®Œç¾è§£å†³äº† C è¯­
è¨€å¸¦æ¥çš„è¿™äº›ç—›ç‚¹ã€‚</p> <ul><li>Rust æœ¬èº«æ”¯æŒæœ€å¸¸ç”¨çš„ä¸‰å¤§æ“ä½œç³»ç»Ÿï¼Œä»£ç å’Œæ„å»ºç³»ç»Ÿæ— é¡»åšè¿‡å¤šè°ƒæ•´å³å¯è·¨å¹³å°ä½¿ç”¨ã€‚</li> <li>Rust ä¸ C ä¹‹é—´æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ï¼Œå³ä½¿éœ€è¦è°ƒç”¨ C è¯­è¨€è½®å­ä¹Ÿä¸ä¼šè¿‡äºç¹çã€‚</li> <li>Rust ä½¿å¾—å¼€å‘è€…åœ¨ç¼–å†™åŠ¨æ€æ¨¡ç»„æ—¶æ— éœ€åƒ C è¯­è¨€ä¸€æ ·ä¸ºäº†å¤„ç†å†…å­˜ç»†èŠ‚è€Œçƒ¦æ¼ã€‚å¯
ä»¥é›†ä¸­ç²¾ç¥åœ¨ä»£ç é€»è¾‘ä¸Šã€‚</li> <li>Emacs module çš„ Rust ç»‘å®šå…·æœ‰è‰¯å¥½çš„æŠ½è±¡å°è£…ï¼Œé¿å…äº†ç›´æ¥ä¸ <code>emacs_module.h</code>  é‡Œå®šä¹‰çš„
åº•å±‚å‡½æ•°äº¤äº’çš„ç¹çç»†èŠ‚ã€‚</li> <li>Rust å…·æœ‰ä¼˜ç§€çš„ç¤¾åŒºç”Ÿæ€ï¼Œå¯ä»¥å¤ç”¨å¤§é‡å¼€æºç¤¾åŒºçš„è½®å­ï¼ŒèŠ‚çº¦äº†å¼€å‘æ—¶é—´ã€‚</li></ul> <h2 id="ç›®æ ‡è¯»è€…ç¾¤"><a href="#ç›®æ ‡è¯»è€…ç¾¤" class="header-anchor">#</a> ç›®æ ‡è¯»è€…ç¾¤</h2> <p>æœ¬æ–‡å‡å®šä½ æœ‰ä¸€å®šçš„ Rust å’Œ Elisp ç¼–ç¨‹ç»éªŒã€‚å¦‚æœä½ æ²¡æœ‰ï¼Œå¯ä»¥å…ˆä»è¿™é‡Œå¼€å§‹</p> <ul><li><a href="https://github.com/rust-lang-cn/rust-by-example-cn" target="_blank" rel="noopener noreferrer">Rust by Exampleï¼ˆä¸­æ–‡ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.gnu.org/software/emacs/manual/eintr.html" target="_blank" rel="noopener noreferrer">An Introduction to Programming in Emacs Lispï¼ˆè‹±
æ–‡ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="header-anchor">#</a> ç¯å¢ƒ</h2> <p>æœ¬èŠ‚è®°å½•å†™ä¸‹æœ¬æ–‡æ‰€ç”¨çš„æ“ä½œç³»ç»Ÿä»¥åŠç›¸å…³è½¯ä»¶çš„ç‰ˆæœ¬</p> <ul><li><code>Archlinux</code></li> <li><code>Emacs 26.3</code></li> <li><code>rustc 1.41.1 (f3e1a954d 2020-02-24)</code></li> <li><code>clang 9.0.1</code></li> <li><code>llvm 9.0.1</code></li></ul> <h2 id="åˆè¯•ç‰›åˆ€"><a href="#åˆè¯•ç‰›åˆ€" class="header-anchor">#</a> åˆè¯•ç‰›åˆ€</h2> <h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="header-anchor">#</a> åˆ›å»ºé¡¹ç›®</h3> <p>æ‰§è¡Œä¸‹åˆ—å‘½ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½ Rust é¡¹ç›®</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>cargo init --lib greeting
<span class="token builtin class-name">cd</span> greeting
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ä¿®æ”¹  <code>Cargo.toml</code>  æ–‡ä»¶</p> <div class="language-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>
<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;greeting&quot;</span>
<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.1.0&quot;</span>
<span class="token key property">edition</span> <span class="token punctuation">=</span> <span class="token string">&quot;2018&quot;</span>
<span class="token comment"># æˆ‘ä»¬é€šå¸¸å¸Œæœ›æŠŠ Emacs ç›¸å…³çš„ package å‘å¸ƒåœ¨ ELPA è€Œä¸æ˜¯ crates.io ä¸Š</span>
<span class="token key property">publish</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>

<span class="token punctuation">[</span><span class="token table class-name">lib</span><span class="token punctuation">]</span>
<span class="token comment"># é‡è¦ï¼Œå¦åˆ™ Rust ä¸ä¼šç”Ÿæˆå…¼å®¹ C ABI çš„åŠ¨æ€åº“</span>
<span class="token key property">crate-type</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;cdylib&quot;</span><span class="token punctuation">]</span>

<span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token comment"># é‡è¦ï¼Œåˆ›å»º Emacs åŠ¨æ€æ¨¡å—çš„å…³é”®ä¾èµ–</span>
<span class="token key property">emacs</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.13&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="ç¼–ç "><a href="#ç¼–ç " class="header-anchor">#</a> ç¼–ç </h3> <p><code>src/lib.rs</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">emacs<span class="token punctuation">::</span></span><span class="token punctuation">{</span>defun<span class="token punctuation">,</span> <span class="token class-name">Env</span><span class="token punctuation">,</span> <span class="token class-name">Result</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å®šä¹‰ä¸€ä¸ª C int ç±»å‹çš„åä¸º plugin_is_GPL_compatible çš„å…¨å±€å˜é‡ï¼Œå¦åˆ™ Emacs ä¼šæ‹’ç»åŠ </span>
<span class="token comment">// è½½æ¨¡å— :)</span>
<span class="token namespace">emacs<span class="token punctuation">::</span></span><span class="token macro property">plugin_is_GPL_compatible!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å®šä¹‰æ¨¡å—å…¥å£ï¼Œå¤§éƒ¨ä»½æƒ…å†µæˆ‘ä»¬ä¸éœ€è¦å®ƒåšä»»ä½•äº‹ã€‚</span>
<span class="token attribute attr-name">#[emacs::module]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span>_<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Env</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/// è¾“å‡ºä¸€æ¡ä½ å¥½ä¿¡æ¯</span>
<span class="token attribute attr-name">#[defun]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">say_hello</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Env</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    env<span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, {}!&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="header-anchor">#</a> ç¼–è¯‘</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>cargo build

<span class="token comment"># å¯¹äºåä¸º libxxx çš„åŠ¨æ€åº“æ–‡ä»¶ï¼Œé¡»æ›´åä¸º crate çš„å‘½åï¼Œä»¥ä¿è¯ emacs-module-rs ç”Ÿ</span>
<span class="token comment"># æˆçš„ provide form æä¾›çš„ feature ä¸æ–‡ä»¶åç›¸åŒ</span>

<span class="token comment"># Linux </span>
<span class="token function">ln</span> -sv target/debug/libgreeting.so greeting.so

<span class="token comment"># Mac</span>
<span class="token function">ln</span> -sv target/debug/libgreeting.dylib greeting.so

<span class="token comment"># Windows</span>
<span class="token comment"># Windows10 é»˜è®¤ç¦æ­¢ä¸€èˆ¬ç”¨æˆ·åˆ›å»ºè½¯é“¾æ¥ï¼Œä½ å¯ä»¥å‚ç…§</span>
<span class="token comment"># https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/create-symbolic-links </span>
<span class="token comment"># ä¸ºä½ è‡ªå·±å¯ç”¨è½¯é“¾æ¥åˆ›é€ æƒé™ï¼Œè¿™é‡Œä½¿ç”¨ç¡¬é“¾æ¥ä½œä¸ºæ›¿ä»£ã€‚</span>
mklink target/debug/greeting.dll greeting.dll
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="åŠ è½½è¿è¡Œ"><a href="#åŠ è½½è¿è¡Œ" class="header-anchor">#</a> åŠ è½½è¿è¡Œ</h3> <div class="language-lisp line-numbers-mode"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token car">add-to-list</span> <span class="token quoted-symbol variable symbol">'load-path</span> <span class="token string">&quot;&lt;path/to/your/project/&gt;&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">require</span> <span class="token quoted-symbol variable symbol">'greeting</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">greeting-say-hello</span> <span class="token string">&quot;Emacs&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è‹¥ä¸€åˆ‡é¡ºåˆ©ï¼Œminibuffer ä¼šå¼¹å‡ºä¿¡æ¯  <code>Hello, Emacs!</code></p> <h2 id="emacs-value"><a href="#emacs-value" class="header-anchor">#</a> <code>emacs::Value</code></h2> <p><code>emacs::Value</code>  æ˜¯åœ¨ Rust è¡¨ç¤º Elisp å€¼çš„ä»£ç†ç±»å‹ï¼Œæ¯ä¸ª  <code>Value</code>  ä»£è¡¨ä¸€ä¸ªå¯¹ Elisp
 å€¼çš„å¼•ç”¨ã€‚ç”±äºå…·ä½“çš„å†…å­˜åˆ†é…å®é™…ä¸Šæ˜¯ Elisp VM çš„ GC åœ¨ç®¡ç†ï¼Œ <code>Value</code>  åœ¨ Rust é‡Œçš„æ‹·è´å’Œ
ç§»åŠ¨æ˜¯ååˆ†è½»é‡çš„ï¼ˆå› æ­¤å®ç°äº†  <code>Copy</code>  traitï¼‰ã€‚</p> <p>Rust æ— æ³•ç›´æ¥åˆ©ç”¨ä¸€ä¸ª  <code>Value</code> ï¼Œåªæœ‰  <code>emacs-module.h</code>  æä¾›äº†è½¬æ¢å‡½æ•°çš„çš„åŸºæœ¬ç±»å‹å¯
ä»¥ç”¨äºè½¬æ¢ã€‚åœ¨åº•å±‚å‡½æ•°ä¹‹ä¸Šï¼Œ <code>emacs-module-rs</code>  åˆæä¾›äº†  <code>IntoLisp</code>  å’Œ <code>FromLisp</code> 
trait ç”¨äºæŠ½è±¡ Rust ç±»å‹åˆ°  <code>Value</code>  ä¹‹é—´çš„è½¬æ¢ã€‚</p> <p>ä¸‹åˆ—ç±»å‹å®ç°äº†è¿™äº› traitsã€‚ä½ ä¹Ÿå¯ä»¥ä¸ºè‡ªå®šä¹‰ç±»å‹å®ç°è¿™äº› traits æ¥å®ç°å¤æ‚æ•°æ®çš„è½¬æ¢ã€‚</p> <ul><li><code>Value</code>  å¯¹åº”è‡ªå·± ğŸ˜›</li> <li><code>i64</code>  å¯¹åº”ä¸€ä¸ª Elisp fixnumï¼ˆ64 ä½æœ‰ç¬¦å·æ•´å‹</li> <li><code>f64</code>  å¯¹åº”ä¸€ä¸ª Elisp floatï¼ˆ64 ä½åŒç²¾åº¦æµ®ç‚¹ï¼‰</li> <li><code>String</code>  å¯¹åº”ä¸€ä¸ª Elisp å­—ç¬¦ä¸²ï¼ˆä¸å« text propertyï¼‰</li> <li><code>emacs::Vector</code>  å¯¹åº”ä¸€ä¸ª Elisp å‘é‡</li> <li><code>()</code>  å¯¹åº” Elisp çš„  <code>nil</code></li> <li><code>Option&lt;T&gt;</code>  å¯¹åº”ä¸€ä¸ªå¯ä¸º  <code>nil</code>  çš„ Elisp å€¼ï¼Œå…·ä½“ç±»å‹ç”±  <code>T</code>  å†³å®š</li></ul> <h2 id="defun"><a href="#defun" class="header-anchor">#</a> <code>#[defun]</code></h2> <p><code>emacs::defun</code>  æ˜¯  <code>emacs-module-rs</code>  æœ€ä¸»è¦çš„é­”æ³•ï¼Œè¿™ä¸ªå±æ€§å®ä¿®é¥°ä¸€ä¸ª Rust çš„å‡½æ•°
å®šä¹‰ï¼Œä½¿å…¶è½¬å˜ä¸ºå¯ä»¥åœ¨ Elisp VM é‡Œè°ƒç”¨çš„æ¨¡å—å‡½æ•°ã€‚</p> <p>è¢«ä¿®é¥°çš„å‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡çš„æ‰€æœ‰æƒç±»å‹ï¼Œä¸”ç±»å‹å®ç°äº† <code>FromLisp</code>  trait çš„å‚æ•°ï¼Œæœ€ç»ˆè¿”å›
 <code>emacs::Result&lt;T&gt;</code>  å…¶ä¸­  <code>T</code>  å®ç° <code>IntoLisp</code>  traitã€‚ç®€åŒ–äº†è¿”å›å’Œå–ç”¨ Elisp å€¼æ—¶æ‰‹åŠ¨è½¬å‹çš„
æ¨¡æ¿ä»£ç ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">/// ä¸€ä¸ªæ„šè ¢ä½†æ˜¯ç®€å•çš„ä¾‹å­ï¼Œè¿™ä¸ªæ³¨é‡Šä¼šè¢«å¯¼å…¥ Emacs çš„å¸®åŠ©ç³»ç»Ÿä¸­ï¼Œ</span>
<span class="token comment">/// é€šè¿‡ M-x describe-function æŸ¥é˜…ã€‚</span>
<span class="token attribute attr-name">#[defun]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>lhs<span class="token punctuation">:</span> <span class="token keyword">i64</span><span class="token punctuation">,</span> rhs<span class="token punctuation">:</span> <span class="token keyword">i64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">emacs<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i64</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>lhs <span class="token operator">+</span> rhs<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="å‘½åä¿®é¥°"><a href="#å‘½åä¿®é¥°" class="header-anchor">#</a> å‘½åä¿®é¥°</h3> <p>Elisp ç¼ºä¹å‘½åç©ºé—´ç³»ç»Ÿï¼Œæ¯ä¸ªåŒ…éƒ½æ‹¥æœ‰è‡ªå·±çš„å‘½åå‰ç¼€æ¥é˜²æ­¢äº§ç”Ÿå‘½åå†²çªã€‚
 <code>emacs-module-rs</code>  å¯¼å‡ºçš„ Elisp å‡½æ•°çš„å‘½åä¿®é¥°æ ¼å¼ä¸º  <code>&lt;åŒ…å&gt;[ç›¸å¯¹äºcrateçš„Rustæ¨¡å—è·¯ å¾„å]&lt;å‡½æ•°å&gt;</code></p> <p>Rust çš„ snake_case é£æ ¼å‘½åä¼šè¢«è½¬æ¢æˆ kebab-case çš„ Lisp é£æ ¼å‘½åï¼Œè¡¨ç¤ºè·¯å¾„çš„
 <code>::</code>  ä¹Ÿä¼šè¢«è½¬æ¢ä¸º Lisp é£æ ¼çš„  <code>-</code></p> <h2 id="è°ƒç”¨elispå‡½æ•°"><a href="#è°ƒç”¨elispå‡½æ•°" class="header-anchor">#</a> è°ƒç”¨ Elisp å‡½æ•°</h2> <h3 id="è°ƒç”¨å…¨å±€é™æ€å‡½æ•°"><a href="#è°ƒç”¨å…¨å±€é™æ€å‡½æ•°" class="header-anchor">#</a> è°ƒç”¨å…¨å±€é™æ€å‡½æ•°</h3> <p><code>emacs::Env</code>  ç±»å‹ä¸Šé™æ€æŒ‚è½½äº†å¸¸ç”¨çš„ Elisp å‡½æ•°ï¼Œè¿™äº›å‡½æ•°é€šå¸¸éƒ½æ˜¯  <code>emacs-module.h</code> 
 ç›´æ¥æš´éœ²å‡ºæ¥çš„ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code>env<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token string">&quot;defun&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

env<span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

env<span class="token punctuation">.</span><span class="token function">type_of</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">.</span><span class="token function">into_lisp</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

env<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;my-module&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

env<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>è¦æ•æ‰ä¸€ä¸ª  <code>Env</code>  æ¥è°ƒç”¨è¿™äº›å‡½æ•°ï¼Œè¯·åœ¨  <code>defun</code>  ä¿®é¥°çš„å‡½æ•°å®šä¹‰é‡Œé¢å¤–åŠ å…¥ä¸€ä¸ªç±»å‹ä¸º
 <code>&amp;Env</code>  çš„å‚æ•°ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">/// æ˜¯çš„ï¼Œè¿™å‡½æ•°å°†ä¸€ä¸ªå­—ç¬¦ä¸² intern ä¸º Elisp symbolã€‚ä½†æ˜¯ä½ ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨ Elisp é‡Œ</span>
<span class="token comment">/// ç”¨ intern å‘¢</span>
<span class="token attribute attr-name">#[defun]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">silly_intern</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'e</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'e</span> <span class="token class-name">Env</span><span class="token punctuation">,</span> s<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">emacs<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'e</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    env<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="è°ƒç”¨ä»»æ„å‡½æ•°"><a href="#è°ƒç”¨ä»»æ„å‡½æ•°" class="header-anchor">#</a> è°ƒç”¨ä»»æ„å‡½æ•°</h3> <p><code>emacs::Env::call(func, args)</code>  å¯ä»¥è°ƒç”¨ä»»æ„ Elisp å‡½æ•°ï¼Œå…¶ä¸­</p> <ul><li><code>func</code>  å¯ä¸ºæ ‡è¯†å‡½æ•°åçš„å­—ç¬¦ä¸²ï¼ˆè°ƒç”¨å¯¹åº”çš„  <code>symbol-function</code> ï¼‰ï¼Œæˆ–è€…å¯è°ƒç”¨çš„
 <code>Value</code>  ï¼ˆå¦‚é—­åŒ…ï¼‰</li> <li><code>args</code>  å¯ä¸ºä¸€ä¸ª  <code>&amp;[Value]</code>  ç±»å‹ï¼Œæˆ–è€…ä¸€ä¸ªåŒ…å«äº† 1-12ï¼ˆå—é™äºå®ç°ï¼Œæš‚æ—¶ä¸Šé™ 12 ä¸ªï¼‰
ä¸ªå…ƒç´ ï¼Œä¸”æ¯ä¸ªå…ƒç´ éƒ½å®ç°äº†  <code>IntoLisp</code>  trait çš„å…ƒç»„</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// (list &quot;str&quot; 2)</span>
env<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> list <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token comment">// (symbol-function 'list)</span>
<span class="token keyword">let</span> subr <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;symbol-function&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>list<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token comment">// (funcall 'list &quot;str&quot; 2)</span>
env<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token comment">// (funcall (symbol-function 'list) &quot;str&quot; 2)</span>
env<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>subr<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
subr<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// ç®€å†™</span>

<span class="token comment">// (add-hook 'text-mode-hook 'variable-pitch-mode)</span>
env<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;add-hook&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    env<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token string">&quot;text-mode-hook&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">,</span>
    env<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token string">&quot;variable-pitch-mode&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">/// å°†ä¸€ä¸ª Elisp Vector è½¬æ¢ä¸º Elisp List</span>
<span class="token attribute attr-name">#[defun]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">listify_vec</span><span class="token punctuation">(</span>vector<span class="token punctuation">:</span> <span class="token class-name">Vector</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> args <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span>vector<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token punctuation">{</span>
        args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>vector<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    vector<span class="token number">.0</span><span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div> <h2 id="å‘elisp-vmåµŒå…¥rustå¤åˆæ•°æ®ç±»å‹"><a href="#å‘elisp-vmåµŒå…¥rustå¤åˆæ•°æ®ç±»å‹" class="header-anchor">#</a> å‘ Elisp VM åµŒå…¥ Rust å¤åˆæ•°æ®ç±»å‹</h2> <p>å°†ä¸€ä¸ª Rust çš„å¤åˆæ•°æ®ç±»å‹å®Œæ•´è½¬æ¢ä¸º Elisp é‡Œçš„æ•°æ®ç±»å‹å¾€å¾€å¾ˆå›°éš¾ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨ Rust
 çº¿ç¨‹å’Œ Elisp VM é—´åå¤è¿›è¡Œæ•°æ®è½¬æ¢ä¼šé™ä½æ¨¡å—æ‰§è¡Œçš„æ•ˆç‡ã€‚å› æ­¤ï¼ŒElisp æä¾› <code>user-ptr</code> 
 ç±»å‹ç”¨äºæ‰¿è½½å¯¹ Elisp ä¸é€æ˜çš„å¤–éƒ¨ç±»å‹å®ä¾‹ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>ä¸ºäº†ä½¿å¯¼å‡ºçš„è‡ªå®šä¹‰ç±»å‹æœ‰æ„ä¹‰ï¼Œä½ è¿˜éœ€è¦é¢å¤–ç¼–å†™æ“ä½œè¯¥æ•°æ®ç±»å‹çš„æ¨¡å—å‡½æ•°ã€‚</p></div> <p><code>user-ptr</code>  ç±»å‹çš„é‡Šæ”¾ç”± Elisp VM çš„ GC æ‰˜ç®¡ï¼Œæ¯”èµ·ä¸€èˆ¬ Rust å¤åˆæ•°æ®ç±»å‹æœ‰é¢å¤–çº¦æŸï¼š</p> <ul><li><code>user-ptr</code>  ç±»å‹å®ä¾‹å¿…é¡»ä½äºå †ä¸Š</li> <li><code>user-ptr</code>  ç±»å‹å…·ä½“ç”Ÿå‘½å‘¨æœŸç¼–è¯‘æ—¶ä¸å¯æ¨æ–­ï¼Œè¢«ç§»åŠ¨è¿› Elisp VM çš„å¤åˆæ•°æ®ç±»å‹
å¿…é¡»æ»¡è¶³  <code>'static</code>  ç”Ÿå‘½å‘¨æœŸçº¦æŸ</li> <li>ç”±äºæ— æ³•é‡æ–°è·å¾—æ‰€æœ‰æƒï¼ŒRust åªèƒ½ç”¨ä¸å¯å˜å¼•ç”¨è®¿é—®  <code>user-ptr</code>  ç±»å‹ï¼Œå¸¸å¸¸éœ€è¦ä½¿ç”¨
å†…éƒ¨å¯å˜æ€§ï¼ˆå•çº¿ç¨‹  <code>RefCell</code> ï¼Œå¤šçº¿ç¨‹é”æœºåˆ¶ï¼ŒåŸå­ç±»å‹ç­‰ï¼‰</li></ul> <p>åœ¨éå¤š Rust çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œ <code>emacs-module-rs</code>  çš„  <code>#[defun]</code>  å®å¯ä»¥ç®€åŒ–å¤§éƒ¨ä»½æ ·æ¿ä»£
ç ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">emacs<span class="token punctuation">::</span></span><span class="token punctuation">{</span>defun<span class="token punctuation">,</span> <span class="token class-name">Env</span><span class="token punctuation">,</span> <span class="token class-name">Result</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[emacs::module(name = <span class="token string">&quot;rs-hash-map&quot;</span>, separator = <span class="token string">&quot;/&quot;</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Env</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Map</span> <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

    <span class="token comment">// æ ‡è®°å‡½æ•°è¿”å›ä¸€ä¸ªç”¨ RefCell åŒ…è£¹çš„ user-ptr ç±»å‹</span>
    <span class="token comment">// #[defun] å®ä¼šè‡ªåŠ¨å°†å…¶åŒ…è£¹æˆ Box&lt;RefCell&lt;Map&gt;&gt;</span>
    <span class="token attribute attr-name">#[defun(user_ptr)]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Map</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åœ¨ #[defun] çš„å‚æ•°ä¸­ï¼Œå¼•ç”¨ç±»å‹æ€»è¡¨ç¤ºç”± #[defun(user-ptr)] åµŒå…¥çš„ user-ptr</span>
    <span class="token comment">// çš„å®ä¾‹çš„å¼•ç”¨</span>
    <span class="token attribute attr-name">#[defun]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span>map<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Map</span><span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token attribute attr-name">#[defun]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">set</span><span class="token punctuation">(</span>map<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Map</span><span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><div class="language-lisp line-numbers-mode"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token car">m</span> <span class="token punctuation">(</span><span class="token car">rs-hash-map/make</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token car">rs-hash-map/get</span> m <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span>     <span class="token comment">; -&gt; nil</span>

  <span class="token punctuation">(</span><span class="token car">rs-hash-map/set</span> m <span class="token string">&quot;a&quot;</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span> <span class="token comment">; -&gt; nil</span>
  <span class="token punctuation">(</span><span class="token car">rs-hash-map/get</span> m <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span>     <span class="token comment">; -&gt; &quot;1&quot;</span>

  <span class="token punctuation">(</span><span class="token car">rs-hash-map/set</span> m <span class="token string">&quot;a&quot;</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span> <span class="token comment">; -&gt; &quot;1&quot;</span>
  <span class="token punctuation">(</span><span class="token car">rs-hash-map/get</span> m <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">; -&gt; &quot;2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="header-anchor">#</a> é”™è¯¯å¤„ç†</h2> <h3 id="åœ¨rustä¸­å¤„ç†elispé”™è¯¯"><a href="#åœ¨rustä¸­å¤„ç†elispé”™è¯¯" class="header-anchor">#</a> åœ¨ Rust ä¸­å¤„ç† Elisp é”™è¯¯</h3> <div class="custom-block warning"><p class="custom-block-title">è­¦å‘Š</p> <p><strong>å¼ºçƒˆä¸å»ºè®®åœ¨ Rust ä»£ç ä¸­å¤„ç† Elisp ä»£ç çš„é”™è¯¯ï¼</strong> åœ¨ Rust ä»£ç ä¸­å¤„ç†å¯èƒ½
çš„ Elisp çš„é”™è¯¯ç¹çä¸”å®¹æ˜“é€ æˆå†…å­˜ä¸å®‰å…¨ï¼ˆæ¶‰åŠ unsafe ä»£ç ï¼‰ã€‚è¯·ç›´æ¥ä½¿ç”¨  <code>?</code>  æ“ä½œç¬¦å‘
ä¸ŠæŠ›å‡ºåœ¨ Rust ä»£ç ä¸­è°ƒç”¨ Elisp ä»£ç æ—¶å¯èƒ½çš„æŠ›é”™ã€‚è¿™äº›é”™è¯¯æœ€ç»ˆä¼šä»¥ <code>rust-error</code>  çš„é”™è¯¯
ç±»å‹æš´éœ²ç»™ Elisp VMã€‚</p></div> <h3 id="åœ¨elispä»£ç ä¸­å¤„ç†rusté”™è¯¯"><a href="#åœ¨elispä»£ç ä¸­å¤„ç†rusté”™è¯¯" class="header-anchor">#</a> åœ¨ Elisp ä»£ç ä¸­å¤„ç† Rust é”™è¯¯</h3> <p><code>emacs-module-rs</code>  æš´éœ²äº†ä¸¤ç§é”™è¯¯ç±»å‹ä¾›ç”¨æˆ·åœ¨ Elisp ç«¯ç”¨ <code>condition-case</code>  å¤„ç†ã€‚</p> <ul><li><code>rust-error</code>  æ‰€æœ‰ç”± Rust åˆ¶é€ çš„é”™è¯¯ã€‚</li> <li><code>rust-wrong-type-user-ptr</code>  å½“å°è¯•æŠŠä¸€ä¸ª lisp å€¼è½¬æ¢ä¸ºä¸€ä¸ª user-ptr åœ¨ Rust é‡Œçš„å€¼æ—¶ï¼Œ
è‹¥ç±»å‹ä¸åŒ¹é…ï¼Œåˆ™æŠ›å‡ºè¯¥é”™è¯¯ã€‚è¯¥é”™è¯¯æ˜¯  <code>rust-error</code>  çš„å­ç±»å‹é”™è¯¯ã€‚</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// å¦‚æœ value å†…å«æœ‰çš„ä¸æ˜¯ RefCell&lt;HashMap&lt;String, String&gt;&gt;ï¼Œæˆ–è€…ç”šè‡³ä¸æ˜¯ä¸€ä¸ª</span>
<span class="token comment">// user-ptrï¼ŒElisp ç«¯ä¼šæŠ›å‡ºä¸€ä¸ª rust-wrong-type-user-ptr é”™è¯¯ã€‚</span>
<span class="token keyword">let</span> r<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">RefCell</span><span class="token operator">&lt;</span><span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;&gt;</span> <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">into_rust</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>å¦‚æœä½ éœ€è¦åœ¨ Rust ä»£ç é‡ŒæŠ›å‡ºç±»å‹æ›´ç²¾ç¡®çš„ Elisp é”™è¯¯ï¼Œå¯ä»¥å°è¯•åœ¨ Rust é‡Œè°ƒç”¨ Elisp å‡½æ•°
 <code>signal</code>  ã€‚</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token attribute attr-name">#[emacs::module(name = <span class="token string">&quot;test&quot;</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span>_<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Env</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token attribute attr-name">#[defun]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">signal_wrong_type</span><span class="token punctuation">(</span>e<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Env</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">&quot;Mismatched type!&quot;</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;signal&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token string">&quot;wrong-type-argument&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
        <span class="token macro property">unreachable!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-lisp line-numbers-mode"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token car">condition-case</span> e
    <span class="token punctuation">(</span><span class="token car">test-signal-wrong-type</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token car">wrong-type-argument</span>
   <span class="token punctuation">(</span><span class="token keyword">message</span> <span class="token punctuation">(</span><span class="token car">error-message-string</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">;; =&gt; &quot;Wrong type argument: \&quot;Mismatched type!\&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <h3 id="åœ¨elispä¸­å¤„ç†rust-panic"><a href="#åœ¨elispä¸­å¤„ç†rust-panic" class="header-anchor">#</a> åœ¨ Elisp ä¸­å¤„ç† Rust panic</h3> <div class="custom-block warning"><p class="custom-block-title">è­¦å‘Š</p> <p>è·¨è¶Š FFI è¾¹ç•Œçš„ unwind æ˜¯ä¸€ä¸ª <strong>æœªå®šä¹‰è¡Œä¸º</strong>ã€‚ <code>emacs-module-rs</code>  ä¼šå°è¯•ç”¨
 <code>catch_unwind</code>  æ•æ‰ panicï¼Œé—æ†¾çš„æ˜¯è¿™å¹¶ä¸æ€»å¥æ•ˆï¼ï¼æœ‰çš„ panic æ ¹æœ¬ä¸ä½¿ç”¨ unwind å®ç°ï¼
 <code>catch_unwind</code>  å¯ä»¥æ•æ‰åˆ°çš„ panic ä¼šå˜æˆä¸€ä¸ª Elisp é”™è¯¯ï¼Œè€Œæ— æ³•æ•æ‰çš„é”™è¯¯å…¶è¡Œä¸ºåˆ™
ä¾èµ–äºå…·ä½“å®ç°ï¼ˆå¦‚è°ƒç”¨ abort å®ç° panic ä¼šæŠŠä½ çš„ Emacs è¿å¸¦å´©æ‰ ğŸ˜›ï¼‰</p> <p>panic å¸¸ä»£è¡¨ä¸å¯æ¢å¤çš„é”™è¯¯ï¼Œè¡¨æ˜ç¨‹åºçš„é€»è¾‘å‡ºäº†é—®é¢˜ã€‚å°½ç®¡æœ‰åŠæ³•åœ¨ Elisp ä¸­æ•æ‰ä¸€ä¸ª
 Rust panicï¼Œä½†æˆ‘ä¸ä¼šåœ¨è¿™é‡Œæ•™ä½ æ€ä¹ˆåšï¼ï¼æ¯”èµ·æ©ç›–é”™è¯¯çš„å‘ç”Ÿï¼Œæ›´åº”è¯¥æ‰¾å‡ºé”™è¯¯çš„åŸ
å› ã€‚</p></div> <h3 id="rusté”™è¯¯ä¹‹é—´çš„äº’ç›¸å¤„ç†"><a href="#rusté”™è¯¯ä¹‹é—´çš„äº’ç›¸å¤„ç†" class="header-anchor">#</a> Rust é”™è¯¯ä¹‹é—´çš„äº’ç›¸å¤„ç†</h3> <p><code>emacs-module-rs</code>  æœ¬èº«ä½¿ç”¨
<a href="https://github.com/rust-lang-nursery/failure" target="_blank" rel="noopener noreferrer"> failure<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> åº“å¤„ç†é”™è¯¯ã€‚å¦‚æœä½ æ°å¥½
ä¹Ÿä½¿ç”¨äº† failure å¤„ç†é”™è¯¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨  <code>?</code>  æ“ä½œç¬¦æŠ›å‡ºä½ çš„é”™è¯¯ï¼Œ
 <code>emacs-module-rs</code>  ä¼šå°†å…¶ç»Ÿä¸€å¤„ç†ä¸º  <code>rust-error</code>  ç±»å‹çš„ Elisp é”™è¯¯æŠ›å‡ºç»™ Elisp VMã€‚</p> <p>å…¶ä»–ç±»å‹çš„é”™è¯¯ï¼Œåœ¨è½¬æ¢ä¸º  <code>failure::Error</code>  åä¹Ÿå¯ä»¥æŒ‰åŒæ ·çš„æ–¹å¼æŠ›å‡ºç»™ Elisp VMã€‚</p> <h2 id="å»¶ä¼¸é˜…è¯»"><a href="#å»¶ä¼¸é˜…è¯»" class="header-anchor">#</a> å»¶ä¼¸é˜…è¯»</h2> <p>æœ¬æ–‡å¯¹ç¼–ç¨‹åŠ¨æ€æ¨¡å—ä¸­ä¸å¸¸è§çš„ç»†èŠ‚åšäº†éƒ¨åˆ†çœç•¥ä»¥ä¿è¯ä½œä¸ºå…¥é—¨è¯»ç‰©çš„å¯è¯»æ€§ï¼Œè¦å®Œæ•´çš„
ç†è§£ <code>emacs-module-rs</code>  ï¼Œè¯·ç§»æ­¥<a href="https://ubolonton.github.io/emacs-module-rs/latest/" target="_blank" rel="noopener noreferrer"> emacs-module-rs's user guideï¼ˆè‹±
æ–‡ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>è¦æ›´æ·±å…¥ç†è§£ Rust è¯­è¨€ä»¥åŠ  <code>emacs-module-rs</code>  èƒŒåçš„é­”æ³•ï¼Œé˜…è¯» Rust å®˜ç½‘æä¾›çš„æ•™ç¨‹æ˜¯
ä¸é”™çš„é€‰æ‹©ã€‚</p> <ul><li><a href="https://doc.rust-lang.org/book/" target="_blank" rel="noopener noreferrer">The Rust Programming Languageï¼ˆè‹±æ–‡ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://doc.rust-lang.org/nomicon" target="_blank" rel="noopener noreferrer">Rust Nomiconï¼ˆè‹±æ–‡ï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>ä¸‹åˆ—æ˜¯ä¸€äº›ç”¨ Rust æ„å»ºåŠ¨æ€æ¨¡å—çš„ Emacs æ’ä»¶åˆ—è¡¨ï¼Œä¹Ÿè®¸å¯ä»¥åœ¨ä½ å†™æ–°æ¨¡å—çš„æ—¶å€™
å¸®åŠ©åˆ°ä½ ã€‚</p> <ul><li><a href="https://github.com/rustify-emacs/fuz.el" target="_blank" rel="noopener noreferrer">fuz.el<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/ubolonton/emacs-tree-sitter" target="_blank" rel="noopener noreferrer">emacs-tree-sitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#æ‘˜è¦" title="æ‘˜è¦">æ‘˜è¦</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©rustè€Œä¸æ˜¯c" title="ä¸ºä»€ä¹ˆé€‰æ‹©Rustè€Œä¸æ˜¯C">ä¸ºä»€ä¹ˆé€‰æ‹©Rustè€Œä¸æ˜¯C</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ç›®æ ‡è¯»è€…ç¾¤" title="ç›®æ ‡è¯»è€…ç¾¤">ç›®æ ‡è¯»è€…ç¾¤</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#ç¯å¢ƒ" title="ç¯å¢ƒ">ç¯å¢ƒ</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#åˆè¯•ç‰›åˆ€" title="åˆè¯•ç‰›åˆ€">åˆè¯•ç‰›åˆ€</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#åˆ›å»ºé¡¹ç›®" title="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#ç¼–ç " title="ç¼–ç ">ç¼–ç </a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#ç¼–è¯‘" title="ç¼–è¯‘">ç¼–è¯‘</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#åŠ è½½è¿è¡Œ" title="åŠ è½½è¿è¡Œ">åŠ è½½è¿è¡Œ</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#emacs-value" title="emacs::Value">emacs::Value</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#defun" title="#[defun]">#[defun]</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#å‘½åä¿®é¥°" title="å‘½åä¿®é¥°">å‘½åä¿®é¥°</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#è°ƒç”¨elispå‡½æ•°" title="è°ƒç”¨Elispå‡½æ•°">è°ƒç”¨Elispå‡½æ•°</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#è°ƒç”¨å…¨å±€é™æ€å‡½æ•°" title="è°ƒç”¨å…¨å±€é™æ€å‡½æ•°">è°ƒç”¨å…¨å±€é™æ€å‡½æ•°</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#è°ƒç”¨ä»»æ„å‡½æ•°" title="è°ƒç”¨ä»»æ„å‡½æ•°">è°ƒç”¨ä»»æ„å‡½æ•°</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å‘elisp-vmåµŒå…¥rustå¤åˆæ•°æ®ç±»å‹" title="å‘Elisp VMåµŒå…¥Rustå¤åˆæ•°æ®ç±»å‹">å‘Elisp VMåµŒå…¥Rustå¤åˆæ•°æ®ç±»å‹</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#é”™è¯¯å¤„ç†" title="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#åœ¨rustä¸­å¤„ç†elispé”™è¯¯" title="åœ¨Rustä¸­å¤„ç†Elispé”™è¯¯">åœ¨Rustä¸­å¤„ç†Elispé”™è¯¯</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#åœ¨elispä»£ç ä¸­å¤„ç†rusté”™è¯¯" title="åœ¨Elispä»£ç ä¸­å¤„ç†Rusté”™è¯¯">åœ¨Elispä»£ç ä¸­å¤„ç†Rusté”™è¯¯</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#åœ¨elispä¸­å¤„ç†rust-panic" title="åœ¨Elispä¸­å¤„ç†Rust panic">åœ¨Elispä¸­å¤„ç†Rust panic</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#rusté”™è¯¯ä¹‹é—´çš„äº’ç›¸å¤„ç†" title="Rusté”™è¯¯ä¹‹é—´çš„äº’ç›¸å¤„ç†">Rusté”™è¯¯ä¹‹é—´çš„äº’ç›¸å¤„ç†</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å»¶ä¼¸é˜…è¯»" title="å»¶ä¼¸é˜…è¯»">å»¶ä¼¸é˜…è¯»</a></div></div></div></div> <footer class="footer" data-v-5317f8db><div class="footer-left-wrap" data-v-5317f8db><ul class="contact" data-v-5317f8db></ul></div> <div class="footer-right-wrap" data-v-5317f8db><ul class="copyright" data-v-5317f8db></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.18bcd6af.js" defer></script><script src="/assets/js/4.3623162e.js" defer></script><script src="/assets/js/5.01fa82bf.js" defer></script><script src="/assets/js/16.1d243b02.js" defer></script>
  </body>
</html>
